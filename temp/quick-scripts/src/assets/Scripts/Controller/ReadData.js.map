{"version":3,"sources":["assets\\Scripts\\Controller\\ReadData.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import JsonParser from \"./JsonParser\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\nexport enum Difficult {\r\n    EASY,\r\n    NORMAL,\r\n    HARD\r\n}\r\n@ccclass('SectionNotes')\r\nexport class SectionNotes {\r\n    timeStart: number = 0;\r\n    pos: number = 0;\r\n    length: number = 0;\r\n}\r\n@ccclass('Notes')\r\nexport class Notes {\r\n    typeOffSection: number = 0;\r\n    lengthInSteps: number = 0;\r\n    sectionNotes: number[][] = [];\r\n    mustHitSection: boolean = false;\r\n    sectionData: SectionNotes[] = [];\r\n}\r\n@ccclass('Song')\r\nexport class Song {\r\n    song: String = \"\";\r\n    notes: Notes[] = [];\r\n    needsVoices: boolean = false;\r\n    speed: number = 0;\r\n    bpm: number = 0;\r\n}\r\n@ccclass('SongData')\r\nexport class SongData {\r\n    song: Song = null;\r\n}\r\n@ccclass('SongClip')\r\nexport class SongClip {\r\n    @property(cc.String)\r\n    song: string = \"\";\r\n    @property({\r\n        type: cc.AudioClip\r\n    })\r\n    clipSong: cc.AudioClip = null;\r\n    @property({\r\n        type: cc.AudioClip\r\n    })\r\n    clipVoice: cc.AudioClip = null;\r\n}\r\n\r\n@ccclass\r\nexport default class ReadData extends cc.Component {\r\n    @property(cc.JsonAsset)\r\n    asset: cc.JsonAsset = null;\r\n    songData: SongData = null;\r\n    // @property([SongClip])\r\n    // songAudio: SongClip[] = [];\r\n    @property(cc.Integer)\r\n    timeStartIChoose: number = 0;\r\n    @property({ type: cc.Enum(Difficult) })\r\n    public diff: Difficult = Difficult.EASY;\r\n    // @property(cc.String)\r\n    // pathData: string = \"\";\r\n    // @property(cc.String)\r\n    // pathSong: string = \"\";\r\n    GetSongData() {\r\n        return this.songData.song;\r\n    }\r\n    GetSongClip() {\r\n\r\n    }\r\n    protected start(): void {\r\n        this.GenerateSFX();\r\n    }\r\n    GenerateSFX() {\r\n        //let diff = Difficult.EASY;\r\n        //let json = cc.sys.localStorage.getItem(this.pathData);\r\n        //let song = JsonParser.parse<SongData>(this.pathData);\r\n        //cc.log(song.song);\r\n        // this.scheduleOnce(() => {\r\n        //     cc.log(JSON.stringify(JsonParser.parse<SongData>(this.pathData)));\r\n        // }, 1);\r\n        // let person: Person = new Person();\r\n        // person.id = 10;\r\n        // person.name = \"Hieu\";\r\n        // let json = JSON.stringify(person);\r\n        // cc.log(json);\r\n        //var url = cc.url.raw(this.pathData);\r\n        //cc.loader.loadRes('24 2zavodila-hard', cc.JsonAsset, (err, res) => {\r\n        //console.log(\"Load Json\");\r\n        //let json = JSON.stringify(res);\r\n        //let song: SongData = Object.assign(new SongData(), JSON.parse(res.json));\r\n        //cc.log(res.json);\r\n        //});     \r\n\r\n\r\n        //RenderData Json - Hieu Wilson \r\n        let songFromJson = this.asset.json[\"song\"][0];\r\n        let songDataFromJson: SongData = new SongData();\r\n        songDataFromJson.song = Object.assign(new SongData(), songFromJson);\r\n        songDataFromJson.song.song = songFromJson.song;\r\n        songDataFromJson.song.notes = songFromJson.notes;\r\n        songDataFromJson.song.needsVoices = songFromJson.needsVoices;\r\n        songDataFromJson.song.speed = songFromJson.speed;\r\n        songDataFromJson.song.bpm = songFromJson.bpm;\r\n        for (let i = 0; i < songFromJson.notes.length; i++) {\r\n            songDataFromJson.song.notes[i].sectionData = [];\r\n            for (let j = 0; j < songFromJson.notes[i].sectionNotes.length; j++) {\r\n                let section: SectionNotes = new SectionNotes();\r\n                section.timeStart = songDataFromJson.song.notes[i].sectionNotes[j][0] / 1000;\r\n                section.pos = Math.round(songDataFromJson.song.notes[i].sectionNotes[j][1]);\r\n                section.length = songDataFromJson.song.notes[i].sectionNotes[j][2];\r\n                songDataFromJson.song.notes[i].sectionData.push(section);\r\n            }\r\n            songDataFromJson.song.notes[i].sectionData.sort((n1, n2) => n1.timeStart - n2.timeStart);\r\n        }\r\n        for (let i = 0; i < songDataFromJson.song.notes.length; i++) {\r\n            for (let j = 0; j < songDataFromJson.song.notes[i].sectionData.length; j++) {\r\n                if (songDataFromJson.song.notes[i].sectionData[j].timeStart < this.timeStartIChoose) {\r\n                    songDataFromJson.song.notes[i].sectionData.splice(j);\r\n                }\r\n            }\r\n        }\r\n\t\t for (let i = 0; i < songDataFromJson.song.notes.length; i++) {\r\n            for (let j = 0; j < songDataFromJson.song.notes[i].sectionData.length; j++) {\r\n                songDataFromJson.song.notes[i].sectionData[j].timeStart  = songDataFromJson.song.notes[i].sectionData[j].timeStart - this.timeStartIChoose;\t\t\t\r\n                }\r\n        }    \r\n        for (let i = 0; i < songDataFromJson.song.notes.length; i++) {\r\n            for (let j = 0; j < songDataFromJson.song.notes[i].sectionData.length; j++) {\r\n                for (let k = j + 1; k < songDataFromJson.song.notes[i].sectionData.length - 1; k++) {\r\n                    if (songDataFromJson.song.notes[i].sectionData[j].timeStart == songDataFromJson.song.notes[i].sectionData[k].timeStart\r\n                        && songDataFromJson.song.notes[i].sectionData[j].pos != songDataFromJson.song.notes[i].sectionData[k].pos) {\r\n                        songDataFromJson.song.notes[i].sectionData[k].pos = songDataFromJson.song.notes[i].sectionData[j].pos;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        this.songData = songDataFromJson;\r\n        // for (let i = 0; i < this.songData.song.notes.length; i++) {\r\n        //     for (let j = 0; j < this.songData.song.notes[i].sectionData.length; j++) {\r\n        //         cc.log(\"time: \" + this.songData.song.notes[i].sectionData[j].timeStart);\r\n        //     }\r\n        // }\r\n    }\r\n\r\n}\r\n\r\n"]}